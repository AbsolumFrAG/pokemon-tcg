<%- include('../partials/header') %>

<div class="container mx-auto px-4 py-8">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold">Mes Cartes</h1>
    <% if (user && user.role === 'admin') { %>
      <a href="/cards/create" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors duration-200">
        Créer une carte
      </a>
    <% } %>
  </div>

  <% if (cards.length === 0) { %>
    <div class="text-center py-8">
      <p class="text-gray-600">Vous n'avez pas encore de cartes dans votre collection.</p>
    </div>
  <% } else { %>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      <% cards.forEach(card => { %>
        <div class="transform hover:scale-105 transition-transform duration-200">
          <!-- Card Container -->
          <a href="/cards/<%= card._id %>" class="block">
            <div class="bg-gradient-to-b rounded-2xl overflow-hidden shadow-lg
              <% if (card.type === 'Fire') { %>from-red-400 to-orange-500
              <% } else if (card.type === 'Water') { %>from-blue-400 to-blue-600
              <% } else if (card.type === 'Grass') { %>from-green-400 to-green-600
              <% } else if (card.type === 'Electric') { %>from-yellow-300 to-yellow-500
              <% } else if (card.type === 'Psychic') { %>from-purple-400 to-purple-600
              <% } else if (card.type === 'Fighting') { %>from-orange-400 to-orange-600
              <% } else { %>from-gray-300 to-gray-500<% } %>">
              
              <!-- Card Header -->
              <div class="p-2 flex justify-between items-center">
                <h2 class="text-lg font-bold text-white"><%= card.name %></h2>
                <span class="text-white font-bold text-sm">HP <%= card.hp %></span>
              </div>

              <!-- Card Image -->
              <div class="bg-gradient-to-b from-white to-gray-100 mx-2 rounded-lg">
                <img src="<%= card.imageUrl %>" alt="<%= card.name %>" 
                  class="w-full h-40 object-contain p-1">
              </div>

              <!-- Card Type and Rarity -->
              <div class="px-2 py-1 flex justify-between items-center text-sm">
                <div class="flex items-center space-x-1">
                  <span class="w-5 h-5 rounded-full flex items-center justify-center
                    <% if (card.type === 'Fire') { %>bg-red-600
                    <% } else if (card.type === 'Water') { %>bg-blue-600
                    <% } else if (card.type === 'Grass') { %>bg-green-600
                    <% } else if (card.type === 'Electric') { %>bg-yellow-500
                    <% } else if (card.type === 'Psychic') { %>bg-purple-600
                    <% } else if (card.type === 'Fighting') { %>bg-orange-600
                    <% } else { %>bg-gray-500<% } %>">
                    <span class="text-white text-xs font-bold"><%= card.type.charAt(0) %></span>
                  </span>
                  <span class="text-white text-xs"><%= card.type %></span>
                </div>
                <span class="px-2 py-0.5 rounded text-xs font-bold
                  <% if (card.rarity === 'Common') { %>bg-gray-200 text-gray-700
                  <% } else if (card.rarity === 'Uncommon') { %>bg-green-200 text-green-700
                  <% } else if (card.rarity === 'Rare') { %>bg-blue-200 text-blue-700
                  <% } else if (card.rarity === 'Ultra Rare') { %>bg-purple-200 text-purple-700
                  <% } else if (card.rarity === 'Secret Rare') { %>bg-yellow-200 text-yellow-700<% } %>">
                  <%= card.rarity %>
                </span>
              </div>

              <!-- Quick Info -->
              <div class="px-2 pb-2">
                <div class="bg-white/10 rounded p-1 mt-1">
                  <% if (card.attacks && card.attacks.length > 0) { %>
                    <div class="text-white text-xs">
                      <%= card.attacks[0].name %> - <%= card.attacks[0].damage %>
                    </div>
                  <% } %>
                </div>
              </div>

              <!-- Serial Number -->
              <% if (card.serialNumber) { %>
                <div class="px-2 pb-2">
                  <div class="text-[10px] text-white/80">
                    № <%= card.serialNumber %>
                  </div>
                </div>
              <% } %>
            </div>
          </a>
        </div>
      <% }) %>
    </div>

    <!-- Pagination -->
    <% if (pagination.totalPages > 1) { %>
      <div class="mt-8 flex justify-center space-x-4">
        <% if (pagination.hasPrev) { %>
          <a href="?page=<%= pagination.page - 1 %>" 
            class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors duration-200">
            Précédent
          </a>
        <% } %>
        
        <span class="px-4 py-2 text-gray-600">
          Page <%= pagination.page %> sur <%= pagination.totalPages %>
        </span>
        
        <% if (pagination.hasNext) { %>
          <a href="?page=<%= pagination.page + 1 %>" 
            class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors duration-200">
            Suivant
          </a>
        <% } %>
      </div>
    <% } %>
  <% } %>
</div>

<%- include('../partials/footer') %>
