<%- include('../partials/header') %>

<div class="container mx-auto px-4 py-8">
  <!-- En-tête avec stats de collection -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-center mb-4">Ma Collection</h1>
    
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 bg-white rounded-lg shadow p-4 mb-4">
      <div class="text-center">
        <span class="block text-sm text-gray-600">Total</span>
        <span class="block text-xl font-bold"><%= cards.length %></span>
      </div>
      <div class="text-center">
        <span class="block text-sm text-gray-600">Communes</span>
        <span class="block text-xl font-bold"><%= cards.filter(card => card.rarity === 'Common').length %></span>
      </div>
      <div class="text-center">
        <span class="block text-sm text-gray-600">Peu communes</span>
        <span class="block text-xl font-bold"><%= cards.filter(card => card.rarity === 'Uncommon').length %></span>
      </div>
      <div class="text-center">
        <span class="block text-sm text-gray-600">Rares</span>
        <span class="block text-xl font-bold"><%= cards.filter(card => card.rarity === 'Rare').length %></span>
      </div>
      <div class="text-center">
        <span class="block text-sm text-gray-600">Ultra Rares</span>
        <span class="block text-xl font-bold"><%= cards.filter(card => card.rarity === 'Ultra Rare').length %></span>
      </div>
    </div>
  </div>

  <!-- Filtres -->
  <div class="bg-white rounded-lg shadow p-4 mb-8">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Type</label>
        <select class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200">
          <option value="">Tous les types</option>
          <option value="Fire">Feu</option>
          <option value="Water">Eau</option>
          <option value="Grass">Plante</option>
          <option value="Electric">Électrique</option>
          <option value="Psychic">Psy</option>
          <option value="Fighting">Combat</option>
          <option value="Normal">Normal</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Rareté</label>
        <select class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200">
          <option value="">Toutes les raretés</option>
          <option value="Common">Commune</option>
          <option value="Uncommon">Peu commune</option>
          <option value="Rare">Rare</option>
          <option value="Ultra Rare">Ultra rare</option>
          <option value="Secret Rare">Secrète rare</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Tri</label>
        <select class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200">
          <option value="name">Nom</option>
          <option value="hp">HP</option>
          <option value="rarity">Rareté</option>
          <option value="createdAt">Date d'obtention</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Grille de cartes -->
  <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
    <% cards.forEach(card => { %>
      <a href="/cards/<%= card._id %>" class="transform hover:scale-105 transition-transform duration-200">
        <div class="relative">
          <!-- Card Frame -->
          <div class="rounded-lg overflow-hidden shadow-lg
            <% if (card.type === 'Fire') { %>bg-gradient-to-b from-red-400 to-orange-500
            <% } else if (card.type === 'Water') { %>bg-gradient-to-b from-blue-400 to-blue-600
            <% } else if (card.type === 'Grass') { %>bg-gradient-to-b from-green-400 to-green-600
            <% } else if (card.type === 'Electric') { %>bg-gradient-to-b from-yellow-300 to-yellow-500
            <% } else if (card.type === 'Psychic') { %>bg-gradient-to-b from-purple-400 to-purple-600
            <% } else if (card.type === 'Fighting') { %>bg-gradient-to-b from-orange-400 to-orange-600
            <% } else { %>bg-gradient-to-b from-gray-300 to-gray-500<% } %>">
            
            <!-- Card Header -->
            <div class="p-1 flex justify-between items-center">
              <h2 class="text-sm font-bold text-white truncate"><%= card.name %></h2>
              <span class="text-white text-xs font-bold">HP <%= card.hp %></span>
            </div>

            <!-- Card Image -->
            <div class="bg-gradient-to-b from-white to-gray-100 mx-1 rounded">
              <img src="<%= card.imageUrl %>" alt="<%= card.name %>" class="w-full h-32 object-contain p-1">
            </div>

            <!-- Card Footer -->
            <div class="p-1">
              <div class="flex justify-between items-center text-xs text-white">
                <span><%= card.type %></span>
                <span class="px-1.5 py-0.5 rounded text-[10px] font-bold
                  <% if (card.rarity === 'Common') { %>bg-gray-200 text-gray-700
                  <% } else if (card.rarity === 'Uncommon') { %>bg-green-200 text-green-700
                  <% } else if (card.rarity === 'Rare') { %>bg-blue-200 text-blue-700
                  <% } else if (card.rarity === 'Ultra Rare') { %>bg-purple-200 text-purple-700
                  <% } else if (card.rarity === 'Secret Rare') { %>bg-yellow-200 text-yellow-700<% } %>">
                  <%= card.rarity %>
                </span>
              </div>
              <% if (card.serialNumber) { %>
                <div class="text-[8px] text-white/80 mt-0.5">№ <%= card.serialNumber %></div>
              <% } %>
            </div>
          </div>
        </div>
      </a>
    <% }) %>
  </div>

  <!-- Pagination -->
  <% if (pagination.totalPages > 1) { %>
    <div classflex justify-center gap-2">
      <% if (pagination.hasPrev) { %>
        <a href="?page=<%= pagination.page - 1 %>" 
          class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition">
          Précédent
        </a>
      <% } %>
      
      <% if (pagination.hasNext) { %>
        <a href="?page=<%= pagination.page + 1 %>" 
          class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition">
          Suivant
        </a>
      <% } %>
    </div>
  <% } %>
</div>

<%- include('../partials/footer') %>
